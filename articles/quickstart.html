<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mapme.biodiversity">
<title>Quickstart • mapme.biodiversity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quickstart">
<meta property="og:description" content="mapme.biodiversity">
<meta property="og:image" content="https://mapme-initiative.github.io/mapme.biodiversity/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mapme.biodiversity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/terminology.html">Terminology</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
    <a class="dropdown-item" href="../articles/contributing.html">Contributing</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-how-to-s">How To's</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-how-to-s">
    <a class="dropdown-item" href="../articles/output-wide.html">Transform output to wide</a>
    <a class="dropdown-item" href="../articles/nasa-firms.html">Use downloaded resources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mapme-initiative/mapme.biodiversity/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quickstart</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mapme-initiative/mapme.biodiversity/blob/HEAD/vignettes/quickstart.Rmd" class="external-link"><code>vignettes/quickstart.Rmd</code></a></small>
      <div class="d-none name"><code>quickstart.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In the following we will demonstrate an idealized workflow based on a
subset of the ESA Landcover dataset that is delivered together with this
package. You can follow along the code snippets below to reproduce the
results. Please note that to reduce the time it takes to process this
vignette, we will not download any resources from the internet. In a
real use case, thus processing time might substantially increase because
resources have to be downloaded and real portfolios might be larger than
the one created in this example.</p>
<p>This vignette assumes that you have already followed the steps in <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/installation.html">Installation</a>
and have familiarized yourself with the terminology used in the package.
If you are unfamiliar with the terminology used here, please head over
to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/terminology.html">Terminology</a>
article to learn about the most important concepts.</p>
<p>The idealized workflow for using <a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a>
consists of the following steps:</p>
<ul>
<li>initialize your portfolio using an sf-object containing only
geometries of type POLYGON</li>
<li>decide which indicator(s) you wish to calculate and download the
required resource(s)</li>
<li>conduct your indicator calculation, which adds a nested list column
to your portfolio object</li>
<li>continue your analysis in R or decide to export your results to a
GeoPackage to use it with other geospatial software</li>
</ul>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>First, we will load the <a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a> and the
<a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package for handling spatial vector data. For tabular
data handling, we will also load the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> and
<a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a>packages. Then, we will read an internal GeoPackage
which includes the geometry of a protected area in the Dominican
Republic from the WDPA database.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">aoi_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sierra_de_neiba_478140.gpkg"</span>, package <span class="op">=</span> <span class="st">"mapme.biodiversity"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="va">aoi_path</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   WDPAID NAME            DESIG_ENG     ISO3                                 geom</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="text-decoration: underline;">478</span>140 Sierra de Neiba National Park DOM   (((-71.76134 18.66333, -71.76067 1…</span></span></code></pre></div>
<p>The sf-object contains a single object of geometry type
<code>MULTIPOLYGON</code>. The <a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a>
package, however, only supports geometries of type <code>POLYGON</code>,
thus we need to cast the geometry before we advance. The resulting sf
object also contains some metadata, that will be retained throughout the
complete workflow. Because some of the cast geometries represent
artefacts of the digitization process, in this example we will subset to
only the largest polygon.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html" class="external-link">st_cast</a></span><span class="op">(</span><span class="va">aoi</span>, to <span class="op">=</span> <span class="st">"POLYGON"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_cast.sf(aoi, to = "POLYGON"): repeating attributes for all</span></span>
<span><span class="co">#&gt; sub-geometries for which they may not be constant</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   WDPAID NAME            DESIG_ENG     ISO3                                 geom</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="text-decoration: underline;">478</span>140 Sierra de Neiba National Park DOM   ((-71.76134 18.66333, -71.76067 18…</span></span></code></pre></div>
<p>In the following, we will simulate a portfolio consisting of several
polygons (assets, in the jargon of this package). To this end, we create
smaller polygons within the original extent of the main polygon. This
way, we can showcase the behavior of the
<a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a> package for portfolios that contain
multiple assets. We will only select single assets with geometry type
<code>POLYGON</code> that lie within the original boundary of the
protected area.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi_gridded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html" class="external-link">st_make_grid</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  square <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geom_type <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html" class="external-link">st_geometry_type</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">geom_type</span> <span class="op">==</span> <span class="st">"POLYGON"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">geom_type</span>, geom <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metanames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">aoi_gridded</span><span class="op">[</span><span class="va">metanames</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initialization-of-a-portfolio">Initialization of a portfolio<a class="anchor" aria-label="anchor" href="#initialization-of-a-portfolio"></a>
</h2>
<p>Now, we are ready to initiate a portfolio object containing multiple
assets. We use the <code><a href="../reference/init_portfolio.html">init_portfolio()</a></code> function and set some
attributes that are important for the subsequent processing. The
function will add a unique identifier column called ‘assetid’ that is
used to uniquely identify each asset in the portfolio.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># copying package internal resource to a temporary location</span></span>
<span><span class="va">outdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"mapme.biodiversity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">outdir</span><span class="op">)</span></span>
<span><span class="va">resource_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"res"</span>, package <span class="op">=</span> <span class="st">"mapme.biodiversity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">resource_dir</span>, <span class="va">outdir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">sample_portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init_portfolio.html">init_portfolio</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">aoi_gridded</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>  outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"res"</span><span class="op">)</span>,</span>
<span>  tmpdir <span class="op">=</span> <span class="va">outdir</span>,</span>
<span>  add_resources <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_portfolio</span><span class="op">[</span><span class="st">"assetid"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="quickstart_files/figure-html/init_portfolio-1.png" width="120%" height="120%"></p>
<p>The first argument, <code>x</code>, is the sf-object that we want to
turn into a portfolio. The argument <code>years</code> allows us to
restrict our analysis to certain years only. Certain resources with a
temporal dimension are only processed for the portfolio’s temporal
extent. All resource and indicator functions will inform the user if the
portfolio’s temporal extent does not intersect. The <code>outdir</code>
and <code>tmpdir</code> arguments point towards directories on the local
file system of your machine. If these directories do not exist, the
package attempts to create them. The <code>outdir</code> cannot be equal
to the <code>tmpdir</code> argument. All downloaded resources will be
written to respective directories nested within <code>outdir</code>. Any
intermediate files during the calculation of an indicator will be
written to <code>tmpdir</code>. Thus, please ensure that you have write
access to both directories and that there is sufficient free disk space
to support the analysis of your portfolio.</p>
<p>In case your share a common <code>outdir</code> across different
portfolios, the <code>add_resources</code> arguments controls the
behavior of the portfolio initialization. If set to <code>TRUE</code>,
the function will automatically search for resources already available
and add these as attributes to the portfolio. Note, this will be done
without further checking if these resources actually match the
spatio-temporal extent of the supplied portfolio. Only use this if you
are sure that for your current portfolio, all resources have been
downloaded previously. If set to <code>FALSE</code>, no pre-existing
resources will be added to the portfolio. Once you request a specific
portfolio for your resources, only those files will be downloaded that
are missing to match its spatio-temporal extent. This behavior is
beneficial if you share the <code>outdir</code> between different
projects to ensure that only matching resources are returned.</p>
<p>Finally, the <code>verbose</code> logical controls whether or not the
package will print informative messages during the calculations. Note,
that even if set to <code>FALSE</code>, the package will inform users
about any potential errors or warnings.</p>
</div>
<div class="section level2">
<h2 id="getting-the-right-resources">Getting the right resources<a class="anchor" aria-label="anchor" href="#getting-the-right-resources"></a>
</h2>
<p>You can check which indicators are available via the
<code><a href="../reference/available_indicators.html">available_indicators()</a></code> function. For this, we inspect the
names of the returned object:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_indicators.html">available_indicators</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "active_fire_counts"           "active_fire_properties"      </span></span>
<span><span class="co">#&gt;  [3] "biome"                        "deforestation_drivers"       </span></span>
<span><span class="co">#&gt;  [5] "drought_indicator"            "ecoregion"                   </span></span>
<span><span class="co">#&gt;  [7] "elevation"                    "fatalities"                  </span></span>
<span><span class="co">#&gt;  [9] "landcover"                    "mangroves_area"              </span></span>
<span><span class="co">#&gt; [11] "population_count"             "precipitation_chirps"        </span></span>
<span><span class="co">#&gt; [13] "precipitation_wc"             "soilproperties"              </span></span>
<span><span class="co">#&gt; [15] "temperature_max_wc"           "temperature_min_wc"          </span></span>
<span><span class="co">#&gt; [17] "traveltime"                   "treecover_area"              </span></span>
<span><span class="co">#&gt; [19] "treecover_area_and_emissions" "treecoverloss_emissions"     </span></span>
<span><span class="co">#&gt; [21] "tri"</span></span></code></pre></div>
<p>Say, we are interested in the landcover indicator. We can learn more
about this indicator and its required resources by using either of the
commands below or, if you are viewing the online version, head over to
the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/landcover.html">landcover</a>
documentation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">landcover</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">landcover</span><span class="op">)</span></span></code></pre></div>
<p>By inspecting the help page we learned that this indicator requires
the <code>esalandcover</code> resource and it does not require to
specify and further arguments.</p>
<p>With that information at hand, we can start to retrieve the required
resource. We can learn about all available resources using the
<code><a href="../reference/available_resources.html">available_resources()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_resources.html">available_resources</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "chirps"                    "esalandcover"             </span></span>
<span><span class="co">#&gt;  [3] "fritz_et_al"               "gfw_emissions"            </span></span>
<span><span class="co">#&gt;  [5] "gfw_lossyear"              "gfw_treecover"            </span></span>
<span><span class="co">#&gt;  [7] "gmw"                       "nasa_firms"               </span></span>
<span><span class="co">#&gt;  [9] "nasa_grace"                "nasa_srtm"                </span></span>
<span><span class="co">#&gt; [11] "nelson_et_al"              "soilgrids"                </span></span>
<span><span class="co">#&gt; [13] "teow"                      "ucdp_ged"                 </span></span>
<span><span class="co">#&gt; [15] "worldclim_max_temperature" "worldclim_min_temperature"</span></span>
<span><span class="co">#&gt; [17] "worldclim_precipitation"   "worldpop"</span></span></code></pre></div>
<p>For the purpose of this vignette, we are going to download the
<code>esalandcover</code> resource. We can get more detailed information
about a given resource, by using either of the commands below to open up
the help page. If you are viewing the online version of this
documentation, you can simply head over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/esalandcover.html">esalandcover</a>
resource documentation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">esalandcover</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">esalandcover</span><span class="op">)</span></span></code></pre></div>
<p>We can now make the <code>esalandcover</code> resource available for
our portfolio. We will use a common interface that is used for all
resources, called <code><a href="../reference/get_resources.html">get_resources()</a></code>. We have to specify our
portfolio object and the names of the resource(s) we wish to download.
Additional arguments for the specific resource can be specified. The
output of the function is the portfolio object with its attributes
appended for the new resource, thus we simply can overwrite the
<code>sample_portfolio</code> variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_resources.html">get_resources</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_portfolio</span>, resources <span class="op">=</span> <span class="st">"esalandcover"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting process to download resource 'esalandcover'........</span></span>
<span><span class="co">#&gt; Checking URLs for existence. This may take a while...</span></span>
<span><span class="co">#&gt; Skipping existing files in output directory.</span></span></code></pre></div>
<p>In case you want to download more than one resource, you can use the
same interface and the resources will be made available sequentially.
Required arguments for a resource are simply added as usual:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_resources.html">get_resources</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">sample_portfolio</span>,</span>
<span>  resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"esalandcover"</span>, <span class="st">"gfw_treecover"</span><span class="op">)</span>,</span>
<span>  vers_treecover <span class="op">=</span> <span class="st">"GFC-2021-v1.9"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-specific-indicators">Calculate specific indicators<a class="anchor" aria-label="anchor" href="#calculate-specific-indicators"></a>
</h2>
<p>The next step consists of calculating specific indicators. Note that
each indicator requires one or more resources that were made available
via the <code><a href="../reference/get_resources.html">get_resources()</a></code> function explained above. Here, we
are going to calculate the <code>landcover</code> indicator which is
based on the <code>esalandcover</code> resource. Since the resource has
been made available in the previous step, we can continue requesting the
calculation of our desired indicator. Note the command below would issue
an error in case a required resource has not been made available via
<code><a href="../reference/get_resources.html">get_resources()</a></code> beforehand.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span><span class="va">sample_portfolio</span>, indicators <span class="op">=</span> <span class="st">"landcover"</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s take a look at the results. We will select only some of the
metadata and the output indicator column to get a clearer picture of
what has happened.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">sample_portfolio</span> <span class="op">&lt;-</span> <span class="va">sample_portfolio</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">assetid</span>, <span class="va">WDPAID</span>, <span class="va">landcover</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 4</span></span></span>
<span><span class="co">#&gt;    assetid WDPAID landcover                                                 geom</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                                           <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.78546 18.658, -71.78546 18.67313, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.80292 18.68321, -71.78546 18.67313, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.76134 18.66333, -71.76067 18.66267, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [5 × 4]&gt;</span>  ((-71.7616 18.69374, -71.7616 18.68691, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.73417 18.64352, -71.71386 18.63179, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.66801 18.63288, -71.69 18.64557, -71.…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.71386 18.68865, -71.71386 18.68691, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.65801 18.68222, -71.66613 18.68691, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [4 × 4]&gt;</span>  ((-71.66613 18.63079, -71.66613 18.62665, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.63562 18.67697, -71.64227 18.67313, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>      11 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span> ((-71.59453 18.66749, -71.59453 18.64815, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>      12 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.52294 18.61972, -71.52294 18.63179, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>      13 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [3 × 4]&gt;</span>  ((-71.54943 18.67465, -71.5468 18.67313, -7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>      14 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.49535 18.64342, -71.49907 18.64557, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>      15 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.46559 18.63735, -71.4752 18.63179, -7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>      16 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [2 × 4]&gt;</span>  ((-71.43534 18.63634, -71.43264 18.63478, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>      17 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.42747 18.62066, -71.42747 18.60424, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>      18 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.35587 18.582, -71.35587 18.59046, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>      19 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.37974 18.61442, -71.37974 18.60424, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>      20 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.34017 18.59953, -71.35587 18.59046, -…</span></span></code></pre></div>
<p>We obtained a new listed column in our sf object that is called like
the requested indicator. For each asset in our portfolio, this column
contains a tibble with variable rows and 4 columns. Let’s have a closer
look at one of these objects.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_portfolio</span><span class="op">$</span><span class="va">landcover</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt;   classes                            year    area percentage</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> shrubs                             2015   47.1    0.034<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> herbaceous_vegetation              2015  262.     0.190   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> closed_forest_evergreen_broad_leaf 2015  190.     0.137   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> closed_forest_deciduous_broad_leaf 2015    1.15   0.000<span style="text-decoration: underline;">833</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> closed_forest_mixed                2015  117.     0.084<span style="text-decoration: underline;">9</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> closed_forest_unknown              2015   10.3    0.007<span style="text-decoration: underline;">49</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> open_forest_evergreen_broad_leaf   2015  201.     0.146   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> open_forest_deciduous_broad_leaf   2015   10.3    0.007<span style="text-decoration: underline;">49</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> open_forest_unknown                2015  541.     0.392</span></span></code></pre></div>
<p>For each asset, the result is a tibble in long format indicating the
absolute area (in ha) and percentage of different landcover types for
the year 2015 (make sure to read the detailed indicator documentation
via <code><a href="../reference/landcover.html">?landcover</a></code>). Let’s quickly visualize the results for a
single asset. For readability of the plot, we will aggregate several
different types of forest into a single class before:</p>
<p><img src="quickstart_files/figure-html/plot_landcover-1.png" width="120%" height="120%"></p>
<p>If you wish to conduct your statistical analysis in R, you can use
<a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a> functionality to unnest one or multiple columns.
Especially for large portfolios, it is usually a good idea to keep the
geometry information in a separated variable to keep the size of the
data object relatively small.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geometries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_portfolio</span>, <span class="va">assetid</span><span class="op">)</span></span>
<span><span class="va">sample_portfolio</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">landcover</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">assetid</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 6</span></span></span>
<span><span class="co">#&gt;   assetid WDPAID classes                            year    area percentage</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       3 <span style="text-decoration: underline;">478</span>140 shrubs                             2015    5.75    0.004<span style="text-decoration: underline;">22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       3 <span style="text-decoration: underline;">478</span>140 herbaceous_vegetation              2015  107.      0.078<span style="text-decoration: underline;">5</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3 <span style="text-decoration: underline;">478</span>140 closed_forest_evergreen_broad_leaf 2015  455.      0.334  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       3 <span style="text-decoration: underline;">478</span>140 closed_forest_mixed                2015  422.      0.310  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       3 <span style="text-decoration: underline;">478</span>140 closed_forest_unknown              2015    6.90    0.005<span style="text-decoration: underline;">07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       3 <span style="text-decoration: underline;">478</span>140 open_forest_evergreen_broad_leaf   2015   98.8     0.072<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>       3 <span style="text-decoration: underline;">478</span>140 open_forest_unknown                2015  265.      0.195</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enabling-parallel-computing">Enabling parallel computing<a class="anchor" aria-label="anchor" href="#enabling-parallel-computing"></a>
</h2>
<p>{mapme.biodiversity} follows the parallelization paradigm of the {<a href="https://cran.r-project.org/package=future" class="external-link">future</a>} package.
That means that you as a user are in the control if and how you would
like to set up parallel processing. Currently,
<a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a> supports parallel processing on the
asset level of the <code><a href="../reference/calc_indicators.html">calc_indicators()</a></code> function only. We also
currently assume that parallel processing is done on the cores of a
single machine. In future developments, we would like to support
distributed processing. If you are working on a distributed use-cases,
please contact the developers, e.g. via the <a href="https://github.com/mapme-initiative/mapme.biodiversity/discussions" class="external-link">discussion
board</a> or mail.</p>
<p>To process e.g. 6 assets in parallel and report a progress bar you
will have to set up the following in your code:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># set up parallel plan with 6 concurrent threads</span></span>
<span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span></span>
<span>    <span class="va">sample_portfolio</span>,</span>
<span>    indicators <span class="op">=</span> <span class="st">"landcover"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span> <span class="co"># close child processes</span></span></code></pre></div>
<p>Note, that the above code uses <code><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">future::multisession()</a></code> as
the parallel backend. This backend will resolve the calculation in
multiple background R sessions. You should use that backend if you are
operating on Windows, using R Studio or otherwise are not sure about
which backend to use. In case you are operating on a system that allows
process forking and are <em>not</em> using R Studio, consider using
<code><a href="https://future.futureverse.org/reference/multicore.html" class="external-link">future::multicore()</a></code> for more efficient parallel
processing.</p>
</div>
<div class="section level2">
<h2 id="exporting-an-portfolio-object">Exporting an portfolio object<a class="anchor" aria-label="anchor" href="#exporting-an-portfolio-object"></a>
</h2>
<p>You can use the <code><a href="../reference/write_portfolio.html">write_portfolio()</a></code> function to save a
processed portfolio object to disk as a GeoPackage. This allows sharing
your data with others who might not be using R, but any other geospatial
software. Simply point towards a non-existing file on your local disk to
write the portfolio. The function will create an individual table for
all processed indicators. Via the <code><a href="../reference/read_portfolio.html">read_portfolio()</a></code>
function, a portfolio which has been written to disk in such a way can
be read back into R. However, users should note that the portfolio-wide
arguments that were set during the portfolio initialization are
<strong>not</strong> reconstructed (e.g. the temporal extent,
<code>outdir</code> and <code>tmpdir</code>, etc.). Thus if you wish to
continue to use <a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a> functionality on such
a portfolio object, make sure to re-run <code><a href="../reference/init_portfolio.html">init_portfolio()</a></code> on
it.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_portfolio.html">write_portfolio</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">sample_portfolio</span>,</span>
<span>  dsn <span class="op">=</span> <span class="va">tmp_output</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing layer `metadata' to data source </span></span>
<span><span class="co">#&gt;   `/tmp/Rtmpgl5AVF/file25a01a0205d3.gpkg' using driver `GPKG'</span></span>
<span><span class="co">#&gt; Writing 20 features with 2 fields and geometry type Polygon.</span></span>
<span><span class="co">#&gt; Updating layer `landcover' to data source `/tmp/Rtmpgl5AVF/file25a01a0205d3.gpkg' using driver `GPKG'</span></span>
<span><span class="co">#&gt; Writing 138 features with 5 fields without geometries.</span></span>
<span><span class="op">(</span><span class="va">portfolio_from_disk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_portfolio.html">read_portfolio</a></span><span class="op">(</span><span class="va">tmp_output</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 4</span></span></span>
<span><span class="co">#&gt;    assetid WDPAID landcover                                                 geom</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                                           <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.78546 18.658, -71.78546 18.67313, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.80292 18.68321, -71.78546 18.67313, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.76134 18.66333, -71.76067 18.66267, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [5 × 4]&gt;</span>  ((-71.7616 18.69374, -71.7616 18.68691, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [7 × 4]&gt;</span>  ((-71.73417 18.64352, -71.71386 18.63179, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.66801 18.63288, -71.69 18.64557, -71.…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.71386 18.68865, -71.71386 18.68691, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.65801 18.68222, -71.66613 18.68691, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [4 × 4]&gt;</span>  ((-71.66613 18.63079, -71.66613 18.62665, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.63562 18.67697, -71.64227 18.67313, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>      11 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span> ((-71.59453 18.66749, -71.59453 18.64815, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>      12 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.52294 18.61972, -71.52294 18.63179, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>      13 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [3 × 4]&gt;</span>  ((-71.54943 18.67465, -71.5468 18.67313, -7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>      14 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.49535 18.64342, -71.49907 18.64557, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>      15 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.46559 18.63735, -71.4752 18.63179, -7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>      16 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [2 × 4]&gt;</span>  ((-71.43534 18.63634, -71.43264 18.63478, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>      17 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [9 × 4]&gt;</span>  ((-71.42747 18.62066, -71.42747 18.60424, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>      18 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.35587 18.582, -71.35587 18.59046, -71…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>      19 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [8 × 4]&gt;</span>  ((-71.37974 18.61442, -71.37974 18.60424, -…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>      20 <span style="text-decoration: underline;">478</span>140 <span style="color: #949494;">&lt;tibble [6 × 4]&gt;</span>  ((-71.34017 18.59953, -71.35587 18.59046, -…</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://dariusgoergen.com/" class="external-link">Darius A. Görgen</a>, Om Prakash Bhandari.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
